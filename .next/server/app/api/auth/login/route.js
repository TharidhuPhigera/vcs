try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="a2e58a82-befe-4a85-8055-124cb9d277a9",e._sentryDebugIdIdentifier="sentry-dbid-a2e58a82-befe-4a85-8055-124cb9d277a9")}catch(e){}try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="a2e58a82-befe-4a85-8055-124cb9d277a9",e._sentryDebugIdIdentifier="sentry-dbid-a2e58a82-befe-4a85-8055-124cb9d277a9")}catch(e){}(()=>{var e={};e.id=758,e.ids=[758],e.modules={44725:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=44725,e.exports=r},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},84297:e=>{"use strict";e.exports=require("async_hooks")},79428:e=>{"use strict";e.exports=require("buffer")},79646:e=>{"use strict";e.exports=require("child_process")},55511:e=>{"use strict";e.exports=require("crypto")},36686:e=>{"use strict";e.exports=require("diagnostics_channel")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},8086:e=>{"use strict";e.exports=require("module")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},74998:e=>{"use strict";e.exports=require("perf_hooks")},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},73566:e=>{"use strict";e.exports=require("worker_threads")},31421:e=>{"use strict";e.exports=require("node:child_process")},53053:e=>{"use strict";e.exports=require("node:diagnostics_channel")},73024:e=>{"use strict";e.exports=require("node:fs")},37067:e=>{"use strict";e.exports=require("node:http")},44708:e=>{"use strict";e.exports=require("node:https")},86592:e=>{"use strict";e.exports=require("node:inspector")},77030:e=>{"use strict";e.exports=require("node:net")},48161:e=>{"use strict";e.exports=require("node:os")},76760:e=>{"use strict";e.exports=require("node:path")},80481:e=>{"use strict";e.exports=require("node:readline")},57075:e=>{"use strict";e.exports=require("node:stream")},41692:e=>{"use strict";e.exports=require("node:tls")},57975:e=>{"use strict";e.exports=require("node:util")},98300:e=>{"use strict";e.exports=require("node:worker_threads")},38522:e=>{"use strict";e.exports=require("node:zlib")},85531:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>U,routeModule:()=>D,serverHooks:()=>N,workAsyncStorage:()=>H,workUnitAsyncStorage:()=>$});var n={};t.r(n),t.d(n,{DELETE:()=>_,GET:()=>k,HEAD:()=>K,OPTIONS:()=>B,PATCH:()=>R,POST:()=>q,PUT:()=>I});var i=t(42611),o=t(53420),s=t(6723),a=t(97391),u=t(63033),c=t(57301),f=t.n(c),l=t(36305),p=t.n(l),d=t(29262),y=t(21452);async function h(e){try{await (0,d.N)();let{username:r,password:t}=await e.json(),n=await y.A.findOne({username:r});if(!n)return new Response(JSON.stringify({message:"User not found"}),{status:404});if(!await f().compare(t,n.password))return new Response(JSON.stringify({message:"Invalid credentials"}),{status:400});let i=p().sign({userId:n._id,role:n.role},process.env.JWT_SECRET,{expiresIn:"1h"});return new Response(JSON.stringify({token:i,role:n.role}),{status:200})}catch(e){return console.error("Error during login:",e),new Response(JSON.stringify({message:"Internal server error"}),{status:500})}}let g={...u},m="workUnitAsyncStorage"in g?g.workUnitAsyncStorage:"requestAsyncStorage"in g?g.requestAsyncStorage:void 0;function b(e,r){return"phase-production-build"===process.env.NEXT_PHASE||"function"!=typeof e?e:new Proxy(e,{apply:(e,t,n)=>{let i;try{let e=m?.getStore();i=e?.headers}catch(e){}return a.wrapRouteHandlerWithSentry(e,{method:r,parameterizedRoute:"/api/auth/login",headers:i}).apply(t,n)}})}let v=b(void 0,"GET"),S=b(h,"POST"),w=b(void 0,"PUT"),x=b(void 0,"PATCH"),E=b(void 0,"DELETE"),j=b(void 0,"HEAD"),T=b(void 0,"OPTIONS"),A={...u},O="workUnitAsyncStorage"in A?A.workUnitAsyncStorage:"requestAsyncStorage"in A?A.requestAsyncStorage:void 0;function P(e,r){return"phase-production-build"===process.env.NEXT_PHASE||"function"!=typeof e?e:new Proxy(e,{apply:(e,t,n)=>{let i;try{let e=O?.getStore();i=e?.headers}catch(e){}return a.wrapRouteHandlerWithSentry(e,{method:r,parameterizedRoute:"/api/auth/login",headers:i}).apply(t,n)}})}let k=P(v,"GET"),q=P(S,"POST"),I=P(w,"PUT"),R=P(x,"PATCH"),_=P(E,"DELETE"),K=P(j,"HEAD"),B=P(T,"OPTIONS"),D=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/tharidhu/vcs/app/api/auth/login/route.js",nextConfigOutput:"",userland:n}),{workAsyncStorage:H,workUnitAsyncStorage:$,serverHooks:N}=D;function U(){return(0,s.patchFetch)({workAsyncStorage:H,workUnitAsyncStorage:$})}},96487:()=>{},78335:()=>{},21452:(e,r,t)=>{"use strict";t.d(r,{A:()=>u});var n=t(56037),i=t.n(n),o=t(57301),s=t.n(o);let a=new(i()).Schema({username:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,required:!0}});a.methods.comparePassword=async function(e){return s().compare(e,this.password)};let u=i().models.User||i().model("User",a)},32984:(e,r,t)=>{"use strict";var n=t(79428).Buffer,i=t(79428).SlowBuffer;function o(e,r){if(!n.isBuffer(e)||!n.isBuffer(r)||e.length!==r.length)return!1;for(var t=0,i=0;i<e.length;i++)t|=e[i]^r[i];return 0===t}e.exports=o,o.install=function(){n.prototype.equal=i.prototype.equal=function(e){return o(this,e)}};var s=n.prototype.equal,a=i.prototype.equal;o.restore=function(){n.prototype.equal=s,i.prototype.equal=a}},4665:(e,r,t)=>{"use strict";var n=t(2450).Buffer,i=t(93352);function o(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function s(e,r,t){for(var n=0;r+n<t&&0===e[r+n];)++n;return e[r+n]>=128&&--n,n}e.exports={derToJose:function(e,r){e=o(e);var t=i(r),s=t+1,a=e.length,u=0;if(48!==e[u++])throw Error('Could not find expected "seq"');var c=e[u++];if(129===c&&(c=e[u++]),a-u<c)throw Error('"seq" specified length of "'+c+'", only "'+(a-u)+'" remaining');if(2!==e[u++])throw Error('Could not find expected "int" for "r"');var f=e[u++];if(a-u-2<f)throw Error('"r" specified length of "'+f+'", only "'+(a-u-2)+'" available');if(s<f)throw Error('"r" specified length of "'+f+'", max of "'+s+'" is acceptable');var l=u;if(u+=f,2!==e[u++])throw Error('Could not find expected "int" for "s"');var p=e[u++];if(a-u!==p)throw Error('"s" specified length of "'+p+'", expected "'+(a-u)+'"');if(s<p)throw Error('"s" specified length of "'+p+'", max of "'+s+'" is acceptable');var d=u;if((u+=p)!==a)throw Error('Expected to consume entire buffer, but "'+(a-u)+'" bytes remain');var y=t-f,h=t-p,g=n.allocUnsafe(y+f+h+p);for(u=0;u<y;++u)g[u]=0;e.copy(g,u,l+Math.max(-y,0),l+f),u=t;for(var m=u;u<m+h;++u)g[u]=0;return e.copy(g,u,d+Math.max(-h,0),d+p),g=(g=g.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,r){e=o(e);var t=i(r),a=e.length;if(a!==2*t)throw TypeError('"'+r+'" signatures must be "'+2*t+'" bytes, saw "'+a+'"');var u=s(e,0,t),c=s(e,t,e.length),f=t-u,l=t-c,p=2+f+1+1+l,d=p<128,y=n.allocUnsafe((d?2:3)+p),h=0;return y[h++]=48,d?y[h++]=p:(y[h++]=129,y[h++]=255&p),y[h++]=2,y[h++]=f,u<0?(y[h++]=0,h+=e.copy(y,h,0,t)):h+=e.copy(y,h,u,t),y[h++]=2,y[h++]=l,c<0?(y[h++]=0,e.copy(y,h,t)):e.copy(y,h,t+c),y}}},93352:e=>{"use strict";function r(e){return(e/8|0)+(e%8==0?0:1)}var t={ES256:r(256),ES384:r(384),ES512:r(521)};e.exports=function(e){var r=t[e];if(r)return r;throw Error('Unknown algorithm "'+e+'"')}},89863:(e,r,t)=>{var n=t(31104);e.exports=function(e,r){r=r||{};var t=n.decode(e,r);if(!t)return null;var i=t.payload;if("string"==typeof i)try{var o=JSON.parse(i);null!==o&&"object"==typeof o&&(i=o)}catch(e){}return!0===r.complete?{header:t.header,payload:i,signature:t.signature}:i}},36305:(e,r,t)=>{e.exports={decode:t(89863),verify:t(49872),sign:t(37676),JsonWebTokenError:t(74668),NotBeforeError:t(64601),TokenExpiredError:t(93501)}},74668:e=>{var r=function(e,r){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,r&&(this.inner=r)};r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,e.exports=r},64601:(e,r,t)=>{var n=t(74668),i=function(e,r){n.call(this,e),this.name="NotBeforeError",this.date=r};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,e.exports=i},93501:(e,r,t)=>{var n=t(74668),i=function(e,r){n.call(this,e),this.name="TokenExpiredError",this.expiredAt=r};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,e.exports=i},69204:(e,r,t)=>{let n=t(93012);e.exports=n.satisfies(process.version,">=15.7.0")},30112:(e,r,t)=>{var n=t(93012);e.exports=n.satisfies(process.version,"^6.12.0 || >=8.0.0")},6646:(e,r,t)=>{let n=t(93012);e.exports=n.satisfies(process.version,">=16.9.0")},63900:(e,r,t)=>{var n=t(18092);e.exports=function(e,r){var t=r||Math.floor(Date.now()/1e3);if("string"==typeof e){var i=n(e);if(void 0===i)return;return Math.floor(t+i/1e3)}if("number"==typeof e)return t+e}},48206:(e,r,t)=>{let n=t(69204),i=t(6646),o={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},s={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};e.exports=function(e,r){if(!e||!r)return;let t=r.asymmetricKeyType;if(!t)return;let a=o[t];if(!a)throw Error(`Unknown key type "${t}".`);if(!a.includes(e))throw Error(`"alg" parameter for "${t}" key type must be one of: ${a.join(", ")}.`);if(n)switch(t){case"ec":let u=r.asymmetricKeyDetails.namedCurve,c=s[e];if(u!==c)throw Error(`"alg" parameter "${e}" requires curve "${c}".`);break;case"rsa-pss":if(i){let t=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:i,saltLength:o}=r.asymmetricKeyDetails;if(n!==`sha${t}`||i!==n)throw Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==o&&o>t>>3)throw Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}}},37676:(e,r,t)=>{let n=t(63900),i=t(30112),o=t(48206),s=t(31104),a=t(77620),u=t(70519),c=t(7965),f=t(90192),l=t(42308),p=t(88704),d=t(55996),{KeyObject:y,createSecretKey:h,createPrivateKey:g}=t(55511),m=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];i&&m.splice(3,0,"PS256","PS384","PS512");let b={expiresIn:{isValid:function(e){return c(e)||p(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return c(e)||p(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return p(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:a.bind(null,m),message:'"algorithm" must be a valid string enum value'},header:{isValid:l,message:'"header" must be an object'},encoding:{isValid:p,message:'"encoding" must be a string'},issuer:{isValid:p,message:'"issuer" must be a string'},subject:{isValid:p,message:'"subject" must be a string'},jwtid:{isValid:p,message:'"jwtid" must be a string'},noTimestamp:{isValid:u,message:'"noTimestamp" must be a boolean'},keyid:{isValid:p,message:'"keyid" must be a string'},mutatePayload:{isValid:u,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:u,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:u,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},v={iat:{isValid:f,message:'"iat" should be a number of seconds'},exp:{isValid:f,message:'"exp" should be a number of seconds'},nbf:{isValid:f,message:'"nbf" should be a number of seconds'}};function S(e,r,t,n){if(!l(t))throw Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(i){let o=e[i];if(!o){if(!r)throw Error('"'+i+'" is not allowed in "'+n+'"');return}if(!o.isValid(t[i]))throw Error(o.message)})}let w={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},x=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];e.exports=function(e,r,t,i){var a,u;"function"==typeof t?(i=t,t={}):t=t||{};let c="object"==typeof e&&!Buffer.isBuffer(e),f=Object.assign({alg:t.algorithm||"HS256",typ:c?"JWT":void 0,kid:t.keyid},t.header);function l(e){if(i)return i(e);throw e}if(!r&&"none"!==t.algorithm)return l(Error("secretOrPrivateKey must have a value"));if(null!=r&&!(r instanceof y))try{r=g(r)}catch(e){try{r=h("string"==typeof r?Buffer.from(r):r)}catch(e){return l(Error("secretOrPrivateKey is not valid key material"))}}if(f.alg.startsWith("HS")&&"secret"!==r.type)return l(Error(`secretOrPrivateKey must be a symmetric key when using ${f.alg}`));if(/^(?:RS|PS|ES)/.test(f.alg)){if("private"!==r.type)return l(Error(`secretOrPrivateKey must be an asymmetric key when using ${f.alg}`));if(!t.allowInsecureKeySizes&&!f.alg.startsWith("ES")&&void 0!==r.asymmetricKeyDetails&&r.asymmetricKeyDetails.modulusLength<2048)return l(Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${f.alg}`))}if(void 0===e)return l(Error("payload is required"));if(c){try{a=e,S(v,!0,a,"payload")}catch(e){return l(e)}t.mutatePayload||(e=Object.assign({},e))}else{let r=x.filter(function(e){return void 0!==t[e]});if(r.length>0)return l(Error("invalid "+r.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==t.expiresIn)return l(Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==t.notBefore)return l(Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{u=t,S(b,!1,u,"options")}catch(e){return l(e)}if(!t.allowInvalidAsymmetricKeyTypes)try{o(f.alg,r)}catch(e){return l(e)}let p=e.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete e.iat:c&&(e.iat=p),void 0!==t.notBefore){try{e.nbf=n(t.notBefore,p)}catch(e){return l(e)}if(void 0===e.nbf)return l(Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==t.expiresIn&&"object"==typeof e){try{e.exp=n(t.expiresIn,p)}catch(e){return l(e)}if(void 0===e.exp)return l(Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(w).forEach(function(r){let n=w[r];if(void 0!==t[r]){if(void 0!==e[n])return l(Error('Bad "options.'+r+'" option. The payload already has an "'+n+'" property.'));e[n]=t[r]}});let m=t.encoding||"utf8";if("function"==typeof i)i=i&&d(i),s.createSign({header:f,privateKey:r,payload:e,encoding:m}).once("error",i).once("done",function(e){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(f.alg)&&e.length<256)return i(Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${f.alg}`));i(null,e)});else{let n=s.sign({header:f,payload:e,secret:r,encoding:m});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(f.alg)&&n.length<256)throw Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${f.alg}`);return n}}},49872:(e,r,t)=>{let n=t(74668),i=t(64601),o=t(93501),s=t(89863),a=t(63900),u=t(48206),c=t(30112),f=t(31104),{KeyObject:l,createSecretKey:p,createPublicKey:d}=t(55511),y=["RS256","RS384","RS512"],h=["ES256","ES384","ES512"],g=["RS256","RS384","RS512"],m=["HS256","HS384","HS512"];c&&(y.splice(y.length,0,"PS256","PS384","PS512"),g.splice(g.length,0,"PS256","PS384","PS512")),e.exports=function(e,r,t,c){let b,v,S;if("function"!=typeof t||c||(c=t,t={}),t||(t={}),t=Object.assign({},t),b=c||function(e,r){if(e)throw e;return r},t.clockTimestamp&&"number"!=typeof t.clockTimestamp)return b(new n("clockTimestamp must be a number"));if(void 0!==t.nonce&&("string"!=typeof t.nonce||""===t.nonce.trim()))return b(new n("nonce must be a non-empty string"));if(void 0!==t.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof t.allowInvalidAsymmetricKeyTypes)return b(new n("allowInvalidAsymmetricKeyTypes must be a boolean"));let w=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return b(new n("jwt must be provided"));if("string"!=typeof e)return b(new n("jwt must be a string"));let x=e.split(".");if(3!==x.length)return b(new n("jwt malformed"));try{v=s(e,{complete:!0})}catch(e){return b(e)}if(!v)return b(new n("invalid token"));let E=v.header;if("function"==typeof r){if(!c)return b(new n("verify must be called asynchronous if secret or public key is provided as a callback"));S=r}else S=function(e,t){return t(null,r)};return S(E,function(r,s){let c;if(r)return b(new n("error in secret or public key callback: "+r.message));let S=""!==x[2].trim();if(!S&&s)return b(new n("jwt signature is required"));if(S&&!s)return b(new n("secret or public key must be provided"));if(!S&&!t.algorithms)return b(new n('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=s&&!(s instanceof l))try{s=d(s)}catch(e){try{s=p("string"==typeof s?Buffer.from(s):s)}catch(e){return b(new n("secretOrPublicKey is not valid key material"))}}if(t.algorithms||("secret"===s.type?t.algorithms=m:["rsa","rsa-pss"].includes(s.asymmetricKeyType)?t.algorithms=g:"ec"===s.asymmetricKeyType?t.algorithms=h:t.algorithms=y),-1===t.algorithms.indexOf(v.header.alg))return b(new n("invalid algorithm"));if(E.alg.startsWith("HS")&&"secret"!==s.type)return b(new n(`secretOrPublicKey must be a symmetric key when using ${E.alg}`));if(/^(?:RS|PS|ES)/.test(E.alg)&&"public"!==s.type)return b(new n(`secretOrPublicKey must be an asymmetric key when using ${E.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{u(E.alg,s)}catch(e){return b(e)}try{c=f.verify(e,v.header.alg,s)}catch(e){return b(e)}if(!c)return b(new n("invalid signature"));let j=v.payload;if(void 0!==j.nbf&&!t.ignoreNotBefore){if("number"!=typeof j.nbf)return b(new n("invalid nbf value"));if(j.nbf>w+(t.clockTolerance||0))return b(new i("jwt not active",new Date(1e3*j.nbf)))}if(void 0!==j.exp&&!t.ignoreExpiration){if("number"!=typeof j.exp)return b(new n("invalid exp value"));if(w>=j.exp+(t.clockTolerance||0))return b(new o("jwt expired",new Date(1e3*j.exp)))}if(t.audience){let e=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(j.aud)?j.aud:[j.aud]).some(function(r){return e.some(function(e){return e instanceof RegExp?e.test(r):e===r})}))return b(new n("jwt audience invalid. expected: "+e.join(" or ")))}if(t.issuer&&("string"==typeof t.issuer&&j.iss!==t.issuer||Array.isArray(t.issuer)&&-1===t.issuer.indexOf(j.iss)))return b(new n("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&j.sub!==t.subject)return b(new n("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&j.jti!==t.jwtid)return b(new n("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&j.nonce!==t.nonce)return b(new n("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if("number"!=typeof j.iat)return b(new n("iat required when maxAge is specified"));let e=a(t.maxAge,j.iat);if(void 0===e)return b(new n('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(w>=e+(t.clockTolerance||0))return b(new o("maxAge exceeded",new Date(1e3*e)))}return!0===t.complete?b(null,{header:E,payload:j,signature:v.signature}):b(null,j)})}},25478:(e,r,t)=>{var n=t(32984),i=t(2450).Buffer,o=t(55511),s=t(4665),a=t(28354),u="secret must be a string or buffer",c="key must be a string or a buffer",f="function"==typeof o.createPublicKey;function l(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!f||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw h(c)}function p(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw h("key must be a string, a buffer or an object")}function d(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function y(e){var r=4-(e=e.toString()).length%4;if(4!==r)for(var t=0;t<r;++t)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function h(e){var r=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,r))}function g(e){var r;return r=e,i.isBuffer(r)||"string"==typeof r||(e=JSON.stringify(e)),e}function m(e){return function(r,t){(function(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!f||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export))throw h(u)})(t),r=g(r);var n=o.createHmac("sha"+e,t);return d((n.update(r),n.digest("base64")))}}function b(e){return function(r,t,o){var s=m(e)(r,o);return n(i.from(t),i.from(s))}}function v(e){return function(r,t){p(t),r=g(r);var n=o.createSign("RSA-SHA"+e);return d((n.update(r),n.sign(t,"base64")))}}function S(e){return function(r,t,n){l(n),r=g(r),t=y(t);var i=o.createVerify("RSA-SHA"+e);return i.update(r),i.verify(n,t,"base64")}}function w(e){return function(r,t){p(t),r=g(r);var n=o.createSign("RSA-SHA"+e);return d((n.update(r),n.sign({key:t,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(e){return function(r,t,n){l(n),r=g(r),t=y(t);var i=o.createVerify("RSA-SHA"+e);return i.update(r),i.verify({key:n,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},t,"base64")}}function E(e){var r=v(e);return function(){var t=r.apply(null,arguments);return s.derToJose(t,"ES"+e)}}function j(e){var r=S(e);return function(t,n,i){return r(t,n=s.joseToDer(n,"ES"+e).toString("base64"),i)}}function T(){return function(){return""}}function A(){return function(e,r){return""===r}}f&&(c+=" or a KeyObject",u+="or a KeyObject"),e.exports=function(e){var r=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!r)throw h('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var t=(r[1]||r[3]).toLowerCase(),n=r[2];return{sign:({hs:m,rs:v,ps:w,es:E,none:T})[t](n),verify:({hs:b,rs:S,ps:x,es:j,none:A})[t](n)}}},31104:(e,r,t)=>{var n=t(15836),i=t(33340);r.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],r.sign=n.sign,r.verify=i.verify,r.decode=i.decode,r.isValid=i.isValid,r.createSign=function(e){return new n(e)},r.createVerify=function(e){return new i(e)}},73999:(e,r,t)=>{var n=t(2450).Buffer,i=t(27910);function o(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}t(28354).inherits(o,i),o.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},o.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=o},15836:(e,r,t)=>{var n=t(2450).Buffer,i=t(73999),o=t(25478),s=t(27910),a=t(22118),u=t(28354);function c(e,r){return n.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var r,t,n,i=e.header,s=e.payload,f=e.secret||e.privateKey,l=e.encoding,p=o(i.alg),d=(r=(r=l)||"utf8",t=c(a(i),"binary"),n=c(a(s),r),u.format("%s.%s",t,n)),y=p.sign(d,f);return u.format("%s.%s",d,y)}function l(e){var r=new i(e.secret||e.privateKey||e.key);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new i(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}u.inherits(l,s),l.prototype.sign=function(){try{var e=f({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},l.sign=f,e.exports=l},22118:(e,r,t)=>{var n=t(79428).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},33340:(e,r,t)=>{var n=t(2450).Buffer,i=t(73999),o=t(25478),s=t(27910),a=t(22118),u=t(28354),c=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function f(e){var r=e.split(".",1)[0];return function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{return JSON.parse(e)}catch(e){return}}(n.from(r,"base64").toString("binary"))}function l(e){return e.split(".")[2]}function p(e){return c.test(e)&&!!f(e)}function d(e,r,t){if(!r){var n=Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=l(e=a(e)),s=e.split(".",2).join(".");return o(r).verify(s,i,t)}function y(e,r){if(r=r||{},!p(e=a(e)))return null;var t,i,o=f(e);if(!o)return null;var s=(t=t||"utf8",i=e.split(".")[1],n.from(i,"base64").toString(t));return("JWT"===o.typ||r.json)&&(s=JSON.parse(s,r.encoding)),{header:o,payload:s,signature:l(e)}}function h(e){var r=new i((e=e||{}).secret||e.publicKey||e.key);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new i(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}u.inherits(h,s),h.prototype.verify=function(){try{var e=d(this.signature.buffer,this.algorithm,this.key.buffer),r=y(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},h.decode=y,h.isValid=p,h.verify=d,e.exports=h},77620:e=>{var r,t,n=1/0,i=0/0,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=/^(?:0|[1-9]\d*)$/,f=parseInt;function l(e){return e!=e}var p=Object.prototype,d=p.hasOwnProperty,y=p.toString,h=p.propertyIsEnumerable,g=(r=Object.keys,t=Object,function(e){return r(t(e))}),m=Math.max,b=Array.isArray;function v(e){var r,t;return null!=e&&"number"==typeof(r=e.length)&&r>-1&&r%1==0&&r<=0x1fffffffffffff&&!("[object Function]"==(t=S(e)?y.call(e):"")||"[object GeneratorFunction]"==t)}function S(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function w(e){return!!e&&"object"==typeof e}e.exports=function(e,r,t,x){e=v(e)?e:(E=e)?function(e,r){for(var t=-1,n=e?e.length:0,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}(v(E)?function(e,r){var t,n=b(e)||w(e)&&v(e)&&d.call(e,"callee")&&(!h.call(e,"callee")||"[object Arguments]"==y.call(e))?function(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}(e.length,String):[],i=n.length,o=!!i;for(var s in e)d.call(e,s)&&!(o&&("length"==s||(t=null==(t=i)?0x1fffffffffffff:t)&&("number"==typeof s||c.test(s))&&s>-1&&s%1==0&&s<t))&&n.push(s);return n}(E):function(e){if(r=e&&e.constructor,e!==("function"==typeof r&&r.prototype||p))return g(e);var r,t=[];for(var n in Object(e))d.call(e,n)&&"constructor"!=n&&t.push(n);return t}(E),function(e){return E[e]}):[],t=t&&!x?(A=(T=(j=t)?(j=function(e){if("number"==typeof e)return e;if("symbol"==typeof(r=e)||w(r)&&"[object Symbol]"==y.call(r))return i;if(S(e)){var r,t="function"==typeof e.valueOf?e.valueOf():e;e=S(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||u.test(e)?f(e.slice(2),n?2:8):s.test(e)?i:+e}(j))===n||j===-n?(j<0?-1:1)*17976931348623157e292:j==j?j:0:0===j?j:0)%1,T==T?A?T-A:T:0):0;var E,j,T,A,O,P=e.length;return t<0&&(t=m(P+t,0)),"string"==typeof(O=e)||!b(O)&&w(O)&&"[object String]"==y.call(O)?t<=P&&e.indexOf(r,t)>-1:!!P&&function(e,r,t){if(r!=r)return function(e,r,t,n){for(var i=e.length,o=t+-1;++o<i;)if(r(e[o],o,e))return o;return -1}(e,l,t);for(var n=t-1,i=e.length;++n<i;)if(e[n]===r)return n;return -1}(e,r,t)>-1}},70519:e=>{var r=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||!!e&&"object"==typeof e&&"[object Boolean]"==r.call(e)}},7965:e=>{var r=1/0,t=0/0,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,u=Object.prototype.toString;function c(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}e.exports=function(e){var f,l,p;return"number"==typeof e&&e==(p=(l=(f=e)?(f=function(e){if("number"==typeof e)return e;if("symbol"==typeof(r=e)||r&&"object"==typeof r&&"[object Symbol]"==u.call(r))return t;if(c(e)){var r,f="function"==typeof e.valueOf?e.valueOf():e;e=c(f)?f+"":f}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var l=o.test(e);return l||s.test(e)?a(e.slice(2),l?2:8):i.test(e)?t:+e}(f))===r||f===-r?(f<0?-1:1)*17976931348623157e292:f==f?f:0:0===f?f:0)%1,l==l?p?l-p:l:0)}},90192:e=>{var r=Object.prototype.toString;e.exports=function(e){return"number"==typeof e||!!e&&"object"==typeof e&&"[object Number]"==r.call(e)}},42308:e=>{var r,t,n=Object.prototype,i=Function.prototype.toString,o=n.hasOwnProperty,s=i.call(Object),a=n.toString,u=(r=Object.getPrototypeOf,t=Object,function(e){return r(t(e))});e.exports=function(e){if(!(e&&"object"==typeof e)||"[object Object]"!=a.call(e)||function(e){var r=!1;if(null!=e&&"function"!=typeof e.toString)try{r=!!(e+"")}catch(e){}return r}(e))return!1;var r=u(e);if(null===r)return!0;var t=o.call(r,"constructor")&&r.constructor;return"function"==typeof t&&t instanceof t&&i.call(t)==s}},88704:e=>{var r=Object.prototype.toString,t=Array.isArray;e.exports=function(e){var n;return"string"==typeof e||!t(e)&&!!(n=e)&&"object"==typeof n&&"[object String]"==r.call(e)}},55996:e=>{var r=1/0,t=0/0,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,u=Object.prototype.toString;function c(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}e.exports=function(e){return function(e,f){var l,p,d,y;if("function"!=typeof f)throw TypeError("Expected a function");return y=(d=(p=e)?(p=function(e){if("number"==typeof e)return e;if("symbol"==typeof(r=e)||r&&"object"==typeof r&&"[object Symbol]"==u.call(r))return t;if(c(e)){var r,f="function"==typeof e.valueOf?e.valueOf():e;e=c(f)?f+"":f}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var l=o.test(e);return l||s.test(e)?a(e.slice(2),l?2:8):i.test(e)?t:+e}(p))===r||p===-r?(p<0?-1:1)*17976931348623157e292:p==p?p:0:0===p?p:0)%1,e=d==d?y?d-y:d:0,function(){return--e>0&&(l=f.apply(this,arguments)),e<=1&&(f=void 0),l}}(2,e)}},18092:e=>{function r(e,r,t,n){return Math.round(e/t)+" "+n+(r>=1.5*t?"s":"")}e.exports=function(e,t){t=t||{};var n,i,o=typeof e;if("string"===o&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"weeks":case"week":case"w":return 6048e5*t;case"days":case"day":case"d":return 864e5*t;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(e);if("number"===o&&isFinite(e))return t.long?(n=Math.abs(e))>=864e5?r(e,n,864e5,"day"):n>=36e5?r(e,n,36e5,"hour"):n>=6e4?r(e,n,6e4,"minute"):n>=1e3?r(e,n,1e3,"second"):e+" ms":(i=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":i>=36e5?Math.round(e/36e5)+"h":i>=6e4?Math.round(e/6e4)+"m":i>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},42611:(e,r,t)=>{"use strict";e.exports=t(44870)},2450:(e,r,t)=>{var n=t(79428),i=n.Buffer;function o(e,r){for(var t in e)r[t]=e[t]}function s(e,r,t){return i(e,r,t)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,r),r.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,r,t){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,r,t)},s.alloc=function(e,r,t){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==r?"string"==typeof t?n.fill(r,t):n.fill(r):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},29262:(e,r,t)=>{"use strict";t.d(r,{N:()=>o});var n=t(56037),i=t.n(n);async function o(){if(!i().connections[0].readyState)try{await i().connect(process.env.MONGO_URI),console.log("Database connected")}catch(e){throw console.error("Database connection failed",e),Error("Database connection failed")}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[723,391,301],()=>t(85531));module.exports=n})();
//# sourceMappingURL=route.js.map